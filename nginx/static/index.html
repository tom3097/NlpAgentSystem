<!DOCTYPE html>
<html>
<head>
	<script src="https://code.jquery.com/jquery-3.3.1.js"
            integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
            crossorigin="anonymous"></script>
    <script type="text/javascript" src="dist/vis.js"></script>
    <link href="dist/vis-network.min.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
    	#mynetwork {
    		width: 1000px;
    		height: 600px;
    		border: 1px solid lightgray;
    	}
  </style>
</head>
<body>

<h1>Product recommendation based on reviews - visualization</h1>

<div id="mynetwork"></div>
<pre id="eventSpan"></pre>

<script>

	window.onload = function () {
	var url = "/agents/opinions/B004GAR91S"
	$.getJSON(url)
	.done(function (data) {
		alert(data.conclusion + ", score: " + data.score);

		var final_score_col = data.score >= 0 ? "#66ff99" : "#ff99ff";

		var _nodes = [ {id: 0, label: 'Laptop is ok', fixed: true, color: final_score_col} ];
		var _edges = []
		var next_id = 1;
		var prev_id = 0;

		var descs = {};

		for (var key in data.arguments) {
			prev_id = 0;
			//alert(key);
			for (var i = 0; i < data.arguments[key].length; ++i) {
				//alert(key);
				var edge_col = data.arguments[key][i]["kind"] == "counter" ? "red" : "green";
				var node_col = data.arguments[key][i]["who"] == "Alice" ? '#FFFF00' : '#97C2FC';
				_nodes.push( {id: next_id, label: data.arguments[key][i]["kind"] + "_" + next_id, fixed: true, color: node_col} );
				_edges.push( {from: prev_id, to: next_id, arrows: 'from', color: {color: edge_col}} );
				descs[next_id] = data.arguments[key][i]["argument"];
				prev_id = next_id;
				next_id += 1;
			}
		}

		var nodes = new vis.DataSet(_nodes);
		var edges = new vis.DataSet(_edges);

		// create a network
		var container = document.getElementById('mynetwork');
		var data = {
			nodes: nodes,
			edges: edges
		};
		var options = {};
		var network = new vis.Network(container, data, options);

		network.on("click", function (params) {
			var node_id = params["nodes"][0];
			if (node_id === undefined) {
				return;
			}
			if (descs[node_id] === undefined) {
				return;
			}
			document.getElementById('eventSpan').innerHTML = descs[node_id];
		});
	})
	.fail(function () {
		alert("error");
	});
	}

</script>

<div id="myDiv" style="height: 20px;"></div>

<script>

var myDiv = document.getElementById("myDiv");

//Create array of options to be added
var array = ["B004GAR91S","B009AEPIPE","B009MPBFNU","B00ATANTRW","B00ATANVLG","B00AUT1RVW","B00AY1FIGG","B00BBLEYXQ","B00BFFDF3I","B00CRY012E","B00DRG9PG4","B00F3ZNQXU","B00FI1FUKG","B00GJUQ4Z0","B00I9HU29K","B00IPQXZ62","B00KHQWRZS","B00NJF1IIG","B00NJNEDSU","B00NJNEEAW","B00NJNEEEI","B00NMVEWC6","B00NNQFO72","B00OVFGU36","B00QD530AI","B00R1HQ1TO","B00REWQNXK","B00RH6QZWM","B00S44ADQU","B00SOYGMQ0","B00T7XT0S4","B00UCENG14","B00UPKMXIC","B014854RBK","B014854RGK","B014VHW24Y","B015PYYPFG","B0161DGXIC","B0163GS05Q","B016UF59WW","B016WM8R9A","B01717WBWO","B017A6S0FS","B019RJSZRO","B019TTJ84Q","B01B6QL2KI","B01B8T58VM","B01BNDI8DS","B01DETDTV0","B01DF599WG","B01E9TXXQK","B01ER4ARCU","B01F3R99HY","B01F7LH5W2","B01FJFMLRU","B01HAQBONI","B01HZT6AR0","B01IUYTLP2","B01J42JPJG","B01K1JW9SK","B01KWCID0E","B01L8PDMOG","B01L8PENTO","B01LNOE4UI","B01LXYG77O","B01LYU3UMJ","B01LZ6XKS6","B01M1JB8RZ","B01M2YY3IU","B01M3R2Y5F","B01M4HQO1M","B01MQJ34SV","B01N0XLHQQ","B01N2BIGDH","B01N5G5PG2","B06W2KCQVD","B06W57W6CX","B06WD61CF5","B06WVM8Q8K","B07193R786","B071LB1GG4","B071NMW1MW","B071V7MXC3","B072598QYG","B0746QGY3M","B074TXHFX4","B075CKH4SJ","B075KFFMZS","B075KPJBNK","B075RGSF13","B076J15LKM","B0774Z5VJN","B077PQ1VNY","B077QGHB4L","B077V4GNL8","B078DN2PVJ","B079WS2NFD","B07C57ZNMC","B07C7NL2L9","B07CZNPYRX"];

//Create and append select list
var selectList = document.createElement("select");
selectList.id = "mySelect";
myDiv.appendChild(selectList);

//Create and append the options
for (var i = 0; i < array.length; i++) {
    var option = document.createElement("option");
    option.value = array[i];
    option.text = array[i];
    selectList.appendChild(option);
}

</script>

</body>
</html> 
